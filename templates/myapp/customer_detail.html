{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/customer_detail.css' %}">
<link rel="stylesheet" href="{% static 'css/customer_detail_additions.css' %}">
{% endblock %}

{% block content %}
<div class="customer-detail-container">
  <!-- Page Header -->
  <div class="page-header">
    <div>
      <h1 class="page-title">Customer Details</h1>
      <nav class="breadcrumb-nav">
        <a href="{% url 'myapp:home' %}">Home</a> >
        <a href="{% url 'myapp:customer_list_class' %}">Customers</a> >
        {{ customer.company_name }}
      </nav>
    </div>
    <div class="header-actions">
      <a
        href="{% url 'myapp:customer_edit' customer.customer_id %}"
        class="btn btn-primary"
      >
        <i class="fas fa-edit"></i> Edit Customer
      </a>
    </div>
  </div>

  <!-- Customer Information Card -->
  <div class="customer-card">
    <!-- Customer Header -->
    <div class="customer-header">
      <h2 class="customer-name">{{ customer.company_name }}</h2>
      <div class="customer-id">ID: {{ customer.customer_id }}</div>
    </div>

    <!-- Customer Details Grid -->
    <div class="customer-details-grid">
      <!-- Contact Information -->
      <div class="detail-section">
        <h3 class="section-title">Contact Information</h3>
        <div class="detail-row">
          <label class="detail-label">Company Name:</label>
          <span class="detail-value">{{ customer.company_name }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Contact Name:</label>
          <span class="detail-value">{{ customer.contact_name|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Contact Title:</label>
          <span class="detail-value">{{ customer.contact_title|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Phone:</label>
          <span class="detail-value">{{ customer.phone|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Fax:</label>
          <span class="detail-value">{{ customer.fax|default:"N/A" }}</span>
        </div>
      </div>

      <!-- Address Information -->
      <div class="detail-section">
        <h3 class="section-title">Address Information</h3>
        <div class="detail-row">
          <label class="detail-label">Address:</label>
          <span class="detail-value">{{ customer.address|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">City:</label>
          <span class="detail-value">{{ customer.city|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Region:</label>
          <span class="detail-value">{{ customer.region|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Postal Code:</label>
          <span class="detail-value">{{ customer.postal_code|default:"N/A" }}</span>
        </div>
        <div class="detail-row">
          <label class="detail-label">Country:</label>
          <span class="detail-value">{{ customer.country|default:"N/A" }}</span>
        </div>
      </div>
    </div>

    <!-- Order Statistics -->
    {% if orders %}
    <div class="orders-section">
      <h3 class="section-title">
        Recent Orders
        <span class="badge">{{ orders.count }} total</span>
      </h3>
      
      <div class="orders-table-container">
        <table class="orders-table">
          <thead>
            <tr>
              <th>Order #</th>
              <th>Order Date</th>
              <th>Required Date</th>
              <th>Employee</th>
              <th>Ship Via</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for order in orders|slice:":10" %}
            <tr>
              <td><strong>#{{ order.order_id }}</strong></td>
              <td>{{ order.order_date|date:"M d, Y" }}</td>
              <td>{{ order.required_date|date:"M d, Y" }}</td>
              <td>{{ order.employee.first_name }} {{ order.employee.last_name }}</td>
              <td>{{ order.ship_via.company_name|default:"N/A" }}</td>
              <td>
                {% if order.shipped_date %}
                  <span class="status-badge status-shipped">Shipped</span>
                {% else %}
                  <span class="status-badge status-pending">Pending</span>
                {% endif %}
              </td>
              <td>
                <a href="{% url 'myapp:order_detail' order.order_id %}" class="btn-link">
                  View Details
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% else %}
    <div class="no-orders-message">
      <p>No orders found for this customer.</p>
      <p class="text-muted">Orders for this customer will appear here once placed.</p>
    </div>
    {% endif %}
  </div>

  <!-- Back Navigation -->
  <div class="back-navigation">
    <a href="{% url 'myapp:customer_list_class' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Back to Customer List
    </a>
  </div>
</div>
{% endblock %}